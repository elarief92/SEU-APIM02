apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: azure-kv-seu-apim-config
  namespace: seu-apim
spec:
  provider: azure
  parameters:
    usePodIdentity: "false"
    useVMManagedIdentity: "false"
    clientID: "ea75c595-d978-4682-9f6d-612a014c68ba"
    keyvaultName: "aks-vault3e49"
    cloudName: "AzurePublicCloud"
    tenantId: "1f00763a-1f87-473b-bba1-b6c746af03e4"
    objects: |
      array:
        # Application Secrets (12)
        - |
          objectName: ats-erp-prod-api-key
          objectType: secret
        - |
          objectName: ats-erp-test-api-key
          objectType: secret
        - |
          objectName: azure-openai-key
          objectType: secret
        - |
          objectName: banner-db-password
          objectType: secret
        - |
          objectName: db-password
          objectType: secret
        - |
          objectName: db-user
          objectType: secret
        - |
          objectName: django-secret-key
          objectType: secret
        - |
          objectName: ejadah-password
          objectType: secret
        - |
          objectName: noordb-password
          objectType: secret
        - |
          objectName: sms-gateway-key
          objectType: secret
        - |
          objectName: yaqeen-password
          objectType: secret
        - |
          objectName: yaqeen-username
          objectType: secret
        # TLS Secrets (2)
        - |
          objectName: tls-cert
          objectType: secret
        - |
          objectName: tls-key
          objectType: secret
        - |
          objectName: database-url
          objectType: secret
          
  secretObjects:
  # First secret: Application secrets
  - data:
    - key: ats-erp-prod-api-key
      objectName: ats-erp-prod-api-key
    - key: ats-erp-test-api-key
      objectName: ats-erp-test-api-key
    - key: azure-openai-key
      objectName: azure-openai-key
    - key: banner-db-password
      objectName: banner-db-password
    - key: db-password
      objectName: db-password
    - key: db-user
      objectName: db-user
    - key: django-secret-key
      objectName: django-secret-key
    - key: ejadah-password
      objectName: ejadah-password
    - key: noordb-password
      objectName: noordb-password
    - key: sms-gateway-key
      objectName: sms-gateway-key
    - key: yaqeen-password
      objectName: yaqeen-password
    - key: yaqeen-username
      objectName: yaqeen-username
    - key: database-url
      objectName: database-url
    secretName: azure-kv-seu-apim-config
    type: Opaque
  
  # Second secret: TLS certificate (same name as your current TLS secret)
  - data:
    - key: tls.crt
      objectName: tls-cert
    - key: tls.key
      objectName: tls-key
    secretName: seu-apim-tls
    type: kubernetes.io/tls